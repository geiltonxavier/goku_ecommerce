<%= form_for(address) do |f| %>
<% if @address.errors.any? %>
  <div  id="error_explanation">
    <h2 class="alert alert-info" ><%= pluralize(@address.errors.count, "error") %> prohibited this mark from being saved:</h2>
 
    <ul>
    <% @address.errors.full_messages.each do |msg| %>
      <li class="alert alert-danger"><%= msg %></li>
    <% end %>
    </ul>
  </div>
<% end %>

    <div class="form-group">
      <%= f.label :CEP, class: "col-sm-2 control-label" %>
      <%= f.text_field :zip_code, class: "form-control input-large" %>
     
     
    </div>

    <div class="form-group">
      <%= f.label :Rua , class: "col-sm-2 control-label"%>
      <%= f.text_field :street, class: "form-control input-large" %>
    </div>

    <div class="form-group">
      <%= f.label :state, class: "col-sm-2 control-label" %>
     
      <%= f.text_field :state, class: "form-control input-large" %>
    </div>

    <div class="form-group">
      <%= f.label :Cidade, class: "col-sm-2 control-label" %>
      <%= f.text_field :city, class: "form-control input-large" %>
    </div>

    <div class="form-group">
      <%= f.label :Bairro, class: "col-sm-2 control-label" %>
      <%= f.text_field :neighborhood, class: "form-control input-large" %>
    </div>

    <div>
        <%= f.submit "Salvar", class: "btn btn-primary" %>
        <%= link_to 'Voltar', addresses_path, class: "btn btn-primary" %>
    </div>

<% end %>

<script>
  
  $("#address_zip_code").blur(function(){
    var zip_code = $("#address_zip_code").val();
    $.get("/addresses/zip_code_search_from_correios?zip_code=" + zip_code, function(data){
      $("#address_state").val(data["state"]);
      $("#address_street").val(data["address"]);
      $("#address_city").val(data["city"]);
      $("#address_neighborhood").val(data["neighborhood"]);
    });
  });

</script>
